Trong thực tế, ta cần chọn p, q có cùng độ dài bit để tạo được 1 mã RSA mạnh, tuy nhiên nếu p, q quá gần nhau thì lại tạo ra lỗ hổng bảo mật khi mà attacker có thể dễ dàng factorize n.

Điều kiện cần
p - q < n¼

Fermat’s factorizing algorithm
Ta có: 
n = p * q = pow(((q-p)/2),2) - pow(((q+p)/2),2) = x^2-y^2

Vậy n có thể được phân tích thừa số nguyên tố như sau: n = (x-y)(x+y).

Giải thuật Fermat giúp tìm p, q:

a =sqrt(n)</br>
b2 = a * a-n</br>
b = sqrt(n)</br>
while(b * b !=b2) :</br>
  a+=1</br>
  b2 = a * a -n</br>
  b = sqrt(b2)</br>

p = a+b</br>
q = a-b</br>

assert n=p * q</br>
return p,q</br>
